/**
 * Copyright 2019 Penn State University
 * @license Apache-2.0, see License.md for full text.
 */
import{LitElement as t,html as e,css as o}from"../../../../lit-element/lit-element.js";import{SimpleToolbarButtonBehaviors as r}from"../../../simple-toolbar/lib/simple-toolbar-button.js";import"../singletons/rich-text-editor-selection.js";import"../../../simple-icon/lib/simple-icon-lite.js";import"../../../simple-icon/lib/simple-icons.js";import"../../../simple-icon/lib/simple-icon-button-lite.js";import"../../../hax-iconset/lib/simple-hax-iconset.js";const i=[o`
    :host {
      --simple-toolbar-border-color: var(--rich-text-editor-border-color, #ddd);
      --simple-toolbar-border-width: var(--rich-text-editor-border-width, 1px);
      --simple-toolbar-button-bg: var(--rich-text-editor-bg, #ffffff);
      --simple-fields-focus-color: var(--rich-text-editor-focus-color, blue);
      --simple-fields-invalid-color: var(--rich-text-editor-error-color, #800);
    }
  `],a=[...i,o`
    :host {
      --simple-toolbar-border-color: var(--rich-text-editor-border-color, #ddd);
      --simple-toolbar-border-width: var(--rich-text-editor-border-width, 1px);
      --simple-toolbar-button-opacity: var(
        --rich-text-editor-button-opacity,
        1
      );
      --simple-toolbar-button-color: var(--rich-text-editor-button-color, #444);
      --simple-toolbar-button-bg: var(--rich-text-editor-button-bg, #ffffff);
      --simple-toolbar-button-border-color: var(
        --rich-text-editor-button-border-color,
        transparent
      );
      --simple-toolbar-button-toggled-opacity: var(
        --rich-text-editor-button-toggled-opacity,
        1
      );
      --simple-toolbar-button-toggled-color: var(
        --rich-text-editor-button-toggled-color,
        #222
      );
      --simple-toolbar-button-toggled-bg: var(
        --rich-text-editor-button-toggled-bg,
        #ddd
      );
      --simple-toolbar-button-toggled-border-color: var(
        --rich-text-editor-button-toggled-border-color,
        transparent
      );
      --simple-toolbar-button-hover-opacity: var(
        --rich-text-editor-button-hover-opacity,
        1
      );
      --simple-toolbar-button-hover-color: var(
        --rich-text-editor-button-hover-color,
        #000
      );
      --simple-toolbar-button-hover-bg: var(
        --rich-text-editor-button-hover-bg,
        #f0f0f0
      );
      --simple-toolbar-button-hover-border-color: var(
        --rich-text-editor-button-hover-border-color,
        unset
      );
      --simple-toolbar-button-disabled-opacity: var(
        --rich-text-editor-button-disabled-opacity,
        1
      );
      --simple-toolbar-button-disabled-color: var(
        --rich-text-editor-button-disabled-color,
        #666
      );
      --simple-toolbar-button-disabled-bg: var(
        --rich-text-editor-button-disabled-bg,
        transparent
      );
      --simple-toolbar-button-disabled-border-color: var(
        --rich-text-editor-button-disabled-border-color,
        transparent
      );
    }
  `],RichTextEditorButtonBehaviors=function(t){return class extends(r(t)){static get tag(){return"rich-text-editor-button"}static get styles(){return[...super.styles,...a]}render(){return super.render()}static get properties(){return{...super.properties,command:{type:String,reflect:!0,attribute:"command"},commandVal:{attribute:"command-val",type:Object},range:{type:Object},tagsList:{type:String},target:{type:Object},toggledCommand:{attribute:"toggled-command",type:String,reflect:!0},toggledCommandVal:{attribute:"toggled-command-val",type:Object},selectedNode:{type:Object},selectionAncestors:{type:Array},__selection:{type:Object}}}constructor(){super(),this.__selection=window.RichTextEditorSelection.requestAvailability(),this.tagsList=""}get isToggled(){let t=!(!this.range||!this.command)&&document.queryCommandState(this.command),e="underline"===this.command?!!this.rangeQuery("u"):t;return!(!this.toggles||!e)}get operationCommand(){return this.isToggled&&this.toggledCommand?this.toggledCommand:this.command}get operationCommandVal(){return this.isToggled&&this.toggledCommand?this.toggledCommandVal||"":this.commandVal}get tagsArray(){return(this.tagsList||"").replace(/\s*/g,"").toLowerCase().split(",")}firstUpdated(t){super.firstUpdated&&super.firstUpdated(t)}updated(t){super.updated(t),t.forEach(((t,e)=>{"controls"===e&&this._editorChanged(this.controls,t),"range"===e&&this._rangeChanged(this.range,t),["shortcutKeys","tagsList","tagClickCallback"].includes(e)&&this.updateButtonRegistry()}))}disconnectedCallback(){super.disconnectedCallback()}commandCallback(t,e,o){}highlight(t=!0){this.dispatchEvent(new CustomEvent("highlight",{bubbles:!0,composed:!0,cancelable:!0,detail:t}))}highlightNode(t){this.dispatchEvent(new CustomEvent("highlightnode",{bubbles:!0,composed:!0,cancelable:!0,detail:t}))}selectRange(t){this.dispatchEvent(new CustomEvent("selectrange",{bubbles:!0,composed:!0,cancelable:!0,detail:t}))}selectNode(t){this.dispatchEvent(new CustomEvent("selectnode",{bubbles:!0,composed:!0,cancelable:!0,detail:t}))}selectNodeContents(t){this.dispatchEvent(new CustomEvent("selectnodeccontents",{bubbles:!0,composed:!0,cancelable:!0,detail:t}))}tagClickCallback(t){}wrapSelection(t){this.dispatchEvent(new CustomEvent("wrapselection",{bubbles:!0,composed:!0,cancelable:!0,detail:t}))}startNode(){let t=this.range?this.range.startContainer:void 0,e=this.range?this.range.startOffset:void 0;return t?t.children?t.children[e-1]:t.childNodes?t.childNodes[e-1]:void 0:void 0}rangeElement(){return this.rangeIsElement()?this.startNode():this.rangeParent()}rangeIsElement(){let t=this.range?this.range.startContainer:void 0,e=this.range?this.range.startOffset:void 0,o=this.range?this.range.endContainer:void 0,r=this.range?this.range.endOffset:void 0;return t===o&&r-e==1}rangeParent(){let t=this.range?this.range.commonAncestorContainer:void 0;return t?1==t.nodeType?t:t.parentElement:void 0}rangeQuery(t=this.tagsList){t=t.toLowerCase().replace(/\s*/g,"");let e=this.rangeElement(),o=e&&e.tagName?e.tagName.toLowerCase():void 0,r=t.split(",");return e?o&&r.includes(o)?e:e.closest(t):void 0}sendCommand(t=this.operationCommand,e=this.operationCommandVal,o=this.range){this.dispatchEvent(new CustomEvent("command",{bubbles:!0,cancelable:!0,composed:!0,detail:{command:t,commandVal:e,range:o,button:this}}))}setRange(){let t=this.rangeQuery();t&&this.selectNode(t)}_handleClick(t){t.preventDefault(),this.sendCommand()}_editorChanged(t,e){}_getSelection(){return"formatBlock"===this.command?this.rangeQuery():this._getSelectedHtml()}_getSelectedHtml(){if(this.range){let t,e=document.createElement("div"),o=this.range.cloneContents();return e.appendChild(o),t=e.innerHTML,e.remove(),t?t.trim():void 0}}_getSelectedTag(){let t=this.rangeQuery();return!(!t||!t.tagName)&&t.tagName.toLowerCase()}_getSelectionType(){return"formatBlock"===this.command?this._getSelectedTag():this._getSelectedHtml()}_rangeChanged(t,e){}}};class RichTextEditorButton extends(RichTextEditorButtonBehaviors(t)){}window.customElements.define(RichTextEditorButton.tag,RichTextEditorButton);export{RichTextEditorButton,RichTextEditorButtonBehaviors,i as RichTextStyles,a as RichTextToolbarStyles};