import{CSVtoArray as t}from"../utils.js";export class gSheetInterface{constructor(t=null,e={}){this.sheetGids=e,this.sheet=null,this.target=t}async loadSheetData(t){return await this.loadCSVData(`https://docs.google.com/spreadsheets/d/e/${this.sheet}/pub?output=csv&gid=${this.sheetGids[t]}`,t)}async loadCSVData(t,e){return await fetch(t,{method:this.method}).then((t=>{if(t.ok)return t.text()})).then((t=>this.handleResponse(t,e)))}async handleResponse(e,s){let a=t(e),h=a.shift(),r={},o=[];for(var i in h)r[h[i]]=i;for(var i in a){let t={};for(var n in r)t[n]=a[i][r[n]];o.push(t)}return"function"==typeof this.target[`process${s}Data`]?this.target[`process${s}Data`](a,r,o):o}}