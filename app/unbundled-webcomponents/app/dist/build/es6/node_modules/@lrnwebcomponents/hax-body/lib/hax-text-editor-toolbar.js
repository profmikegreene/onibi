/**
 * Copyright 2021 The Pennsylvania State University
 * @license Apache-2.0, see License.md for full text.
 */
import{LitElement as t,html as e,css as i}from"../../../lit-element/lit-element.js";import{RichTextEditorToolbarBehaviors as r}from"../../rich-text-editor/lib/toolbars/rich-text-editor-toolbar.js";import{HaxTextEditorButton as s}from"./hax-text-editor-button.js";import{HAXStore as o}from"./hax-store.js";class HaxTextEditorToolbar extends(r(t)){static get styles(){return[super.baseStyles,super.miniStyles]}render(){return super.miniTemplate}static get properties(){return{...super.properties,__registeredElements:{type:Object},__updated:{type:Boolean}}}tag(){return"hax-text-editor-toolbar"}constructor(){super(),this.tag=HaxTextEditorToolbar.tag,this.sticky=!1,this.config=this.defaultConfig,this.__registeredElements=[],this.__updated=!1}get defaultConfig(){return[this.basicInlineButtonGroup,this.linkButtonGroup,this.scriptButtonGroup,this.listIndentButtonGroup]}firstUpdated(t){super.firstUpdated&&super.firstUpdated(t),this.config=this.updateToolbarElements(),window.addEventListener("hax-store-ready",this._handleHaxStoreReady.bind(this)),window.addEventListener("hax-register-properties",this._handleElementRegister.bind(this))}_handleElementRegister(t){let e=t.detail||{},i=e.tag||{},r=e.properties||{};this._setInlineElement(i,r)}_handleHaxStoreReady(t){let e=o.elementList||{};Object.keys(e).forEach((t=>this._setInlineElement(t,elemets[t])))}_setInlineElement(t,e){if(!t||!e||this.__registeredElements[t]||t.indexOf("-")<0)return;((e.gizmo||{}).handles||[]).filter((t=>"inline"===t.type)).length>0&&(this.__registeredElements[t]={element:e,type:"hax-text-editor-button"},this.__updated=!1,setTimeout(this.updateToolbarElements.bind(this),500))}updateToolbarElements(){if(this.__updated)return;this.__updated=!0;let t=Object.keys(this.__registeredElements||{}).map((t=>this.__registeredElements[t]));this.config=[...this.defaultConfig,{type:"button-group",buttons:t},this.sourceButtonGroup],this.updateToolbar()}}customElements.define("hax-text-editor-toolbar",HaxTextEditorToolbar);export{HaxTextEditorToolbar};