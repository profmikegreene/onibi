/**
 * @license
 * Copyright (c) 2021 - 2022 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */
import{animationFrame as e}from"../../component-base/src/async.js";import{ControllerMixin as r}from"../../component-base/src/controller-mixin.js";import{Debouncer as t}from"../../component-base/src/debounce.js";import{ErrorController as o}from"./error-controller.js";import{FieldAriaController as l}from"./field-aria-controller.js";import{HelperController as i}from"./helper-controller.js";import{LabelMixin as s}from"./label-mixin.js";import{ValidateMixin as n}from"./validate-mixin.js";export const FieldMixin=h=>class FieldMixinClass extends(n(s(r(h)))){static get properties(){return{ariaTarget:{type:Object,observer:"_ariaTargetChanged"},errorMessage:{type:String,observer:"_errorMessageChanged"},helperText:{type:String,observer:"_helperTextChanged"},_helperId:String}}static get observers(){return["__observeOffsetHeight(errorMessage, invalid, label, helperText)","_invalidChanged(invalid)","_requiredChanged(required)"]}get _errorId(){return this._errorController.errorId}get _errorNode(){return this._errorController.node}get _helperId(){return this._helperController.helperId}get _helperNode(){return this._helperController.node}constructor(){super(),this._fieldAriaController=new l(this),this._helperController=new i(this),this._errorController=new o(this),this.addController(this._fieldAriaController),this.addController(this._helperController),this.addController(this._errorController),this._labelController.addEventListener("label-changed",(e=>{const{hasLabel:r,node:t}=e.detail;this.__labelChanged(r,t)})),this._helperController.addEventListener("helper-changed",(e=>{const{hasHelper:r,node:t}=e.detail;this.__helperChanged(r,t)}))}__helperChanged(e,r){e?this._fieldAriaController.setHelperId(r.id):this._fieldAriaController.setHelperId(null)}_dispatchIronResizeEventIfNeeded(e,r){const t="__old"+e;void 0!==this[t]&&this[t]!==r&&this.dispatchEvent(new CustomEvent("iron-resize",{bubbles:!0,composed:!0})),this[t]=r}__observeOffsetHeight(){this.__observeOffsetHeightDebouncer=t.debounce(this.__observeOffsetHeightDebouncer,e,(()=>{this._dispatchIronResizeEventIfNeeded("Height",this.offsetHeight)}))}__labelChanged(e,r){e?this._fieldAriaController.setLabelId(r.id):this._fieldAriaController.setLabelId(null)}_errorMessageChanged(e){this._errorController.setErrorMessage(e)}_helperTextChanged(e){this._helperController.setHelperText(e)}_ariaTargetChanged(e){e&&this._fieldAriaController.setTarget(e)}_requiredChanged(e){this._fieldAriaController.setRequired(e)}_invalidChanged(e){this._errorController.setInvalid(e),setTimeout((()=>{e?this._fieldAriaController.setErrorId(this._errorController.errorId):this._fieldAriaController.setErrorId(null)}))}};