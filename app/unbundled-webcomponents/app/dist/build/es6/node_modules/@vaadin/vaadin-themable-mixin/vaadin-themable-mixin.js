/**
 * @license
 * Copyright (c) 2017 - 2022 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */
import{css as e,CSSResult as t,unsafeCSS as n}from"../../lit/index.js";import{ThemePropertyMixin as s}from"./vaadin-theme-property-mixin.js";export{e as css,n as unsafeCSS};const i=[];export function registerStyles(e,t,n={}){if(e){const t=customElements.get(e);t&&Object.prototype.hasOwnProperty.call(t,"__finalized")&&console.warn(`The custom element definition for "${e}"\n      was finalized before a style module was registered.\n      Make sure to add component specific style modules before\n      importing the corresponding custom element.`)}t=recursiveFlattenStyles(t),window.Vaadin&&window.Vaadin.styleModules?window.Vaadin.styleModules.registerStyles(e,t,n):i.push({themeFor:e,styles:t,include:n.include,moduleId:n.moduleId})}function getAllThemes(){return window.Vaadin&&window.Vaadin.styleModules?window.Vaadin.styleModules.getAllThemes():i}function getIncludePriority(e=""){let t=0;return 0===e.indexOf("lumo-")||0===e.indexOf("material-")?t=1:0===e.indexOf("vaadin-")&&(t=2),t}function recursiveFlattenStyles(e=[],n=[]){return e instanceof t?n.push(e):Array.isArray(e)?e.forEach((e=>recursiveFlattenStyles(e,n))):console.warn("An item in styles is not of type CSSResult. Use `unsafeCSS` or `css`."),n}function getIncludedStyles(e){const t=[];return e.include&&[].concat(e.include).forEach((e=>{const n=getAllThemes().find((t=>t.moduleId===e));n?t.push(...getIncludedStyles(n),...n.styles):console.warn(`Included moduleId ${e} not found in style registry`)}),e.styles),t}function getThemes(e){const t=e+"-default-theme",n=getAllThemes().filter((n=>n.moduleId!==t&&function matchesThemeFor(e,t){return(e||"").split(" ").some((e=>new RegExp("^"+e.split("*").join(".*")+"$").test(t)))}(n.themeFor,e))).map((e=>({...e,styles:[...getIncludedStyles(e),...e.styles],includePriority:getIncludePriority(e.moduleId)}))).sort(((e,t)=>t.includePriority-e.includePriority));return n.length>0?n:getAllThemes().filter((e=>e.moduleId===t))}export const ThemableMixin=e=>class VaadinThemableMixin extends(s(e)){static finalize(){super.finalize();const e=this.prototype._template;if(!e||e.__themes)return;const t=Object.getPrototypeOf(this.prototype)._template,n=(t?t.__themes:[])||[];e.__themes=[...n,...getThemes(this.is)];!function addStylesToTemplate(e,t){const n=document.createElement("style");n.innerHTML=e.filter(((t,n)=>n===e.lastIndexOf(t))).map((e=>e.cssText)).join("\n"),t.content.appendChild(n)}(e.__themes.reduce(((e,t)=>[...e,...t.styles]),[]),e)}static finalizeStyles(e){return getThemes(this.is).reduce(((e,t)=>[...e,...t.styles]),[]).concat(e)}};export{i as __themeRegistry};