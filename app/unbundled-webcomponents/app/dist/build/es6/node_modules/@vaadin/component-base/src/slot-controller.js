/**
 * @license
 * Copyright (c) 2021 - 2022 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */
import{dashToCamelCase as t}from"../../../@polymer/polymer/lib/utils/case-map.js";import{FlattenedNodesObserver as e}from"../../../@polymer/polymer/lib/utils/flattened-nodes-observer.js";export class SlotController extends EventTarget{constructor(t,e,o,s){super(),this.host=t,this.slotName=e,this.slotFactory=o,this.slotInitializer=s,this.defaultId=SlotController.generateId(e,t)}static generateId(e,o){const s=e||"default",i=`${t(s)}Id`;return this[i]=1+this[i]||0,`${s}-${o.localName}-${this[i]}`}hostConnected(){if(!this.initialized){let t=this.getSlotChild();t?(this.node=t,this.initCustomNode(t)):t=this.attachDefaultNode(),this.initNode(t),this.observe(),this.initialized=!0}}attachDefaultNode(){const{host:t,slotName:e,slotFactory:o}=this;let s=this.defaultNode;return!s&&o&&(s=o(t),s instanceof Element&&(""!==e&&s.setAttribute("slot",e),this.node=s,this.defaultNode=s)),s&&t.appendChild(s),s}getSlotChild(){const{slotName:t}=this;return Array.from(this.host.childNodes).find((e=>e.nodeType===Node.ELEMENT_NODE&&e.slot===t||e.nodeType===Node.TEXT_NODE&&e.textContent.trim()&&""===t))}initNode(t){const{slotInitializer:e}=this;e&&e(this.host,t)}initCustomNode(t){}teardownNode(t){}observe(){const{slotName:t}=this,o=""===t?"slot:not([name])":`slot[name=${t}]`,s=this.host.shadowRoot.querySelector(o);this.__slotObserver=new e(s,(t=>{const e=this.node,o=t.addedNodes.find((t=>t!==e));t.removedNodes.length&&t.removedNodes.forEach((t=>{this.teardownNode(t)})),o&&(e&&e.isConnected&&this.host.removeChild(e),this.node=o,o!==this.defaultNode&&(this.initCustomNode(o),this.initNode(o)))}))}}